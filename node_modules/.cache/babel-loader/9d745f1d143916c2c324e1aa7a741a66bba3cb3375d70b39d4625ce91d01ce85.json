{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mrmst\\\\OneDrive\\\\Documentos\\\\Front End\\\\ClusterWarehouse\\\\src\\\\Components\\\\CriarEtiqueta.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport * as XLSX from 'xlsx';\nimport { API_ENDPOINTS } from '../config';\nimport './CriarEtiqueta.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction CriarEtiqueta() {\n  _s();\n  const [imei, setImei] = useState('');\n  const [excelData, setExcelData] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [progress, setProgress] = useState({\n    total: 0,\n    processed: 0,\n    success: 0,\n    errors: 0\n  });\n  const [clusterId, setClusterId] = useState(null);\n  const [isGeneratingQrCode, setIsGeneratingQrCode] = useState(false);\n  const [qrCodeImage, setQrCodeImage] = useState(null);\n  const fileInputRef = useRef(null);\n\n  // Limpar o progresso quando os dados do Excel forem alterados\n  useEffect(() => {\n    if (excelData.length === 0) {\n      setProgress({\n        total: 0,\n        processed: 0,\n        success: 0,\n        errors: 0\n      });\n    }\n  }, [excelData]);\n  const handleGenerateQrCode = async () => {\n    if (!clusterId) {\n      console.error('Nenhum clusterId disponível');\n      alert('Erro: Nenhum clusterId disponível para gerar o QR code');\n      return;\n    }\n    console.log('Iniciando geração do QR code para o cluster:', clusterId);\n    setIsGeneratingQrCode(true);\n    try {\n      // 1. Primeiro tenta a abordagem direta com CORS\n      const url = API_ENDPOINTS.CLUSTER_QRCODE(clusterId);\n      const timestamp = new Date().getTime();\n      const urlWithCacheBust = `${url}${url.includes('?') ? '&' : '?'}_=${timestamp}`;\n      console.log('Tentando carregar QR code de:', urlWithCacheBust);\n\n      // Tenta primeiro com CORS\n      try {\n        // Primeiro faz uma requisição HEAD para verificar o tipo de conteúdo\n        const headResponse = await fetch(urlWithCacheBust, {\n          method: 'HEAD',\n          headers: {\n            'Accept': 'image/png,image/*;q=0.8',\n            'Cache-Control': 'no-cache'\n          },\n          redirect: 'manual' // Não seguir redirecionamentos automaticamente\n        });\n        console.log('Resposta HEAD:', {\n          status: headResponse.status,\n          type: headResponse.type,\n          redirected: headResponse.redirected,\n          url: headResponse.url,\n          headers: Object.fromEntries(headResponse.headers.entries())\n        });\n\n        // Se for um redirecionamento, pega a nova URL\n        let finalUrl = urlWithCacheBust;\n        if ([301, 302, 303, 307, 308].includes(headResponse.status)) {\n          const location = headResponse.headers.get('location');\n          if (location) {\n            finalUrl = new URL(location, url).toString();\n            console.log('Redirecionado para:', finalUrl);\n          }\n        }\n\n        // Agora faz a requisição GET para a URL final\n        const response = await fetch(finalUrl, {\n          method: 'GET',\n          headers: {\n            'Accept': 'image/png,image/*;q=0.8',\n            'Cache-Control': 'no-cache'\n          }\n        });\n        const contentType = response.headers.get('content-type') || '';\n        console.log('Content-Type da resposta:', contentType);\n        if (response.ok) {\n          // Se for uma imagem, processa normalmente\n          if (contentType.startsWith('image/')) {\n            const blob = await response.blob();\n            if (blob && blob.size > 0) {\n              const reader = new FileReader();\n              return new Promise(resolve => {\n                reader.onloadend = () => {\n                  setQrCodeImage(reader.result);\n                  resolve();\n                };\n                reader.onerror = error => {\n                  console.error('Erro ao ler o blob:', error);\n                  const imageUrl = URL.createObjectURL(blob);\n                  setQrCodeImage(imageUrl);\n                  resolve();\n                };\n                reader.readAsDataURL(blob);\n              });\n            }\n          } else {\n            // Se não for uma imagem, tenta extrair a URL da imagem da resposta\n            const text = await response.text();\n            console.log('Resposta não é uma imagem:', text.substring(0, 200) + '...');\n\n            // Tenta encontrar uma URL de imagem na resposta\n            const imgMatch = text.match(/<img[^>]+src=\"([^\">]+)\"/i);\n            if (imgMatch && imgMatch[1]) {\n              const imgSrc = new URL(imgMatch[1], finalUrl).toString();\n              console.log('Encontrada URL de imagem na resposta:', imgSrc);\n              setQrCodeImage(imgSrc);\n              return;\n            }\n            throw new Error('A resposta não contém uma imagem válida');\n          }\n        }\n      } catch (corsError) {\n        console.log('Erro na requisição CORS, tentando abordagem alternativa...', corsError);\n      }\n\n      // 2. Se a abordagem CORS falhar, tenta usar um iframe para exibir a URL\n      console.log('Tentando carregar QR code em um iframe...');\n\n      // Cria um iframe temporário para carregar a página\n      const iframe = document.createElement('iframe');\n      iframe.style.display = 'none';\n      document.body.appendChild(iframe);\n      return new Promise(resolve => {\n        iframe.onload = async () => {\n          try {\n            // Tenta capturar o conteúdo do iframe\n            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;\n\n            // Tenta encontrar uma imagem no iframe\n            const img = iframeDoc.querySelector('img');\n            if (img && img.src) {\n              console.log('Imagem encontrada no iframe:', img.src);\n              setQrCodeImage(img.src);\n              document.body.removeChild(iframe);\n              resolve();\n              return;\n            }\n\n            // Se não encontrar, tiga o conteúdo do iframe\n            console.log('Conteúdo do iframe:', iframeDoc.documentElement.outerHTML.substring(0, 500) + '...');\n\n            // Tenta extrair a URL da imagem do HTML\n            const html = iframeDoc.documentElement.outerHTML;\n            const imgMatch = html.match(/<img[^>]+src=[\"']([^\"']+)[\"']/i);\n            if (imgMatch && imgMatch[1]) {\n              const imgSrc = new URL(imgMatch[1], url).toString();\n              console.log('URL da imagem extraída:', imgSrc);\n              setQrCodeImage(imgSrc);\n              document.body.removeChild(iframe);\n              resolve();\n              return;\n            }\n            throw new Error('Não foi possível encontrar uma imagem na resposta');\n          } catch (e) {\n            console.error('Erro ao processar iframe:', e);\n            // Se tudo falhar, tenta usar a URL diretamente\n            setQrCodeImage(urlWithCacheBust);\n            document.body.removeChild(iframe);\n            resolve();\n          }\n        };\n\n        // Define um timeout para remover o iframe se algo der errado\n        setTimeout(() => {\n          if (document.body.contains(iframe)) {\n            document.body.removeChild(iframe);\n            setQrCodeImage(urlWithCacheBust);\n            resolve();\n          }\n        }, 5000);\n\n        // Carrega a URL no iframe\n        iframe.src = urlWithCacheBust;\n      });\n    } catch (error) {\n      console.error('Erro ao gerar QR code:', error);\n      alert(`Erro ao gerar QR code: ${error.message}\\n\\nVerifique se o servidor está rodando e acessível.`);\n    } finally {\n      setIsGeneratingQrCode(false);\n    }\n  };\n  const handleImeiChange = e => {\n    setImei(e.target.value);\n  };\n  const enviarLoteParaAPI = async (lote, loteIndex, totalLotes) => {\n    try {\n      const response = await fetch(API_ENDPOINTS.CLUSTERS, {\n        method: 'POST',\n        headers: {\n          'accept': 'application/json',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          nome: `Lote ${loteIndex + 1} de ${totalLotes}`,\n          imeis: lote,\n          descricao: `Lote ${loteIndex + 1} de IMEIs processados`\n        })\n      });\n      if (!response.ok) {\n        throw new Error(`Erro no lote ${loteIndex + 1}: ${response.status}`);\n      }\n      const data = await response.json();\n      if (data.cluster_id) {\n        setClusterId(data.cluster_id);\n      }\n      return {\n        success: true,\n        data\n      };\n    } catch (error) {\n      console.error(`Erro no lote ${loteIndex + 1}:`, error);\n      return {\n        success: false,\n        error,\n        imeis: lote\n      };\n    }\n  };\n  const processarIMEsEmLotes = async (imeis, tamanhoLote = 10) => {\n    const lotes = [];\n    for (let i = 0; i < imeis.length; i += tamanhoLote) {\n      lotes.push(imeis.slice(i, i + tamanhoLote));\n    }\n    const resultados = [];\n    const totalLotes = lotes.length;\n    for (let i = 0; i < lotes.length; i++) {\n      const lote = lotes[i];\n      setProgress(prev => ({\n        ...prev,\n        loteAtual: i + 1,\n        totalLotes\n      }));\n      const resultado = await enviarLoteParaAPI(lote, i, totalLotes);\n      resultados.push(resultado);\n      setProgress(prev => ({\n        ...prev,\n        processed: prev.processed + lote.length,\n        success: resultado.success ? prev.success + lote.length : prev.success,\n        errors: !resultado.success ? prev.errors + lote.length : prev.errors\n      }));\n    }\n    return resultados;\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (isLoading) return;\n    try {\n      if (imei.trim()) {\n        // Processar apenas o IMEI digitado\n        const imeiUnico = imei.trim();\n        console.log('Processando IMEI:', imeiUnico);\n        setIsLoading(true);\n        setProgress({\n          total: 1,\n          processed: 0,\n          success: 0,\n          errors: 0\n        });\n\n        // Criar um arquivo CSV temporário com o IMEI\n        const csvContent = `IMEI\\n${imeiUnico}`;\n        const blob = new Blob([csvContent], {\n          type: 'text/csv'\n        });\n        const file = new File([blob], 'imei.csv', {\n          type: 'text/csv'\n        });\n\n        // Processar o arquivo CSV\n        await processarArquivoCSV(file);\n        setImei('');\n      } else if (excelData.length > 0) {\n        // Se houver dados do Excel, converter para CSV e enviar\n        const csvContent = ['IMEI',\n        // Cabeçalho\n        ...excelData.map(item => (item.IMEI || item.imei || item.Imei || '').trim()).filter(Boolean)].join('\\n');\n        const blob = new Blob([csvContent], {\n          type: 'text/csv'\n        });\n        const file = new File([blob], 'imeis.csv', {\n          type: 'text/csv'\n        });\n        await processarArquivoCSV(file);\n        handleClearFile();\n      } else {\n        alert('Por favor, insira um IMEI, carregue um arquivo CSV ou Excel.');\n      }\n    } catch (error) {\n      console.error('Erro ao processar:', error);\n      alert(error.message || 'Ocorreu um erro ao processar. Verifique o console para mais detalhes.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const processarArquivoCSV = async file => {\n    setIsLoading(true);\n    setProgress({\n      total: 1,\n      processed: 0,\n      success: 0,\n      errors: 0\n    });\n    const formData = new FormData();\n    formData.append('file', file);\n    try {\n      const url = new URL(API_ENDPOINTS.PROCESSAR_CSV);\n      url.searchParams.append('criar_cluster_automatico', 'true');\n      url.searchParams.append('nome_cluster', 'Cluster gerado a partir de CSV');\n      const response = await fetch(url, {\n        method: 'POST',\n        headers: {\n          'accept': 'application/json'\n        },\n        body: formData\n      });\n      if (!response.ok) {\n        throw new Error(`Erro ao processar o arquivo: ${response.statusText}`);\n      }\n      const result = await response.json();\n      console.log('Arquivo processado com sucesso:', result);\n\n      // Atualiza o estado do clusterId se estiver na resposta\n      if (result.cluster_id) {\n        setClusterId(result.cluster_id);\n      }\n      setProgress(prev => ({\n        ...prev,\n        processed: 1,\n        success: 1\n      }));\n      return result;\n    } catch (error) {\n      console.error('Erro ao processar o arquivo:', error);\n      setProgress(prev => ({\n        ...prev,\n        errors: 1\n      }));\n      throw error;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleFileUpload = async e => {\n    const file = e.target.files[0];\n    if (!file) return;\n    try {\n      // Verifica se é um arquivo CSV\n      if (!file.name.endsWith('.csv') && !file.type.includes('csv')) {\n        throw new Error('Por favor, selecione um arquivo CSV.');\n      }\n\n      // Processa o arquivo CSV diretamente\n      await processarArquivoCSV(file);\n\n      // Limpa o input de arquivo\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (error) {\n      console.error('Erro:', error);\n      alert(error.message || 'Erro ao processar o arquivo. Verifique o console para mais detalhes.');\n    }\n  };\n  const handleClearFile = () => {\n    setExcelData([]);\n    setImei('');\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"criar-etiqueta\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Gerar Etiqueta de IMEI\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 398,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"importar-excel\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Importar IMEIs do Excel/CSV\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        accept: \".csv, .xlsx, .xls\",\n        onChange: handleFileUpload,\n        ref: fileInputRef,\n        style: {\n          display: 'none'\n        },\n        id: \"file-upload\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"file-upload-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"file-upload-button\",\n          onClick: () => document.getElementById('file-upload').click(),\n          children: isLoading ? 'Processando...' : 'Selecionar Arquivo (CSV/Excel)'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 11\n        }, this), excelData.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"file-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: [excelData.length, \" IMEIs carregados\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"clear-button\",\n            onClick: handleClearFile,\n            children: \"Limpar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 421,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 400,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"divider\",\n      children: \"ou\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 433,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"imei\",\n          children: \"IMEI:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 437,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"imei\",\n          name: \"imei\",\n          value: imei,\n          onChange: handleImeiChange,\n          required: excelData.length === 0,\n          disabled: excelData.length > 0,\n          placeholder: \"Digite o n\\xFAmero do IMEI\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 438,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"button-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"submit-button\",\n          disabled: isLoading,\n          children: isLoading ? /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\"Processando... \", progress.processed, \"/\", progress.total]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 15\n          }, this) : excelData.length > 0 ? `Gerar ${excelData.length} Etiquetas` : 'Processar IMEIs'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 11\n        }, this), isLoading && progress.total > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"progress-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Processando: \", progress.processed, \" de \", progress.total, \" IMEIs\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 468,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"progress-bar\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"progress-bar-fill\",\n              style: {\n                width: `${progress.processed / progress.total * 100}%`\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 470,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 469,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Sucesso: \", progress.success, \" | Erros: \", progress.errors]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 475,\n            columnNumber: 15\n          }, this), progress.loteAtual && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"progress-info\",\n            children: [\"Lote \", progress.loteAtual, \" de \", progress.totalLotes, \" \\u2022 Sucessos: \", progress.success, \" \\u2022 Erros: \", progress.errors]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 477,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"qr-code-button-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: `criar-etiqueta-btn ${!clusterId || isGeneratingQrCode ? 'disabled' : ''}`,\n            onClick: handleGenerateQrCode,\n            disabled: !clusterId || isGeneratingQrCode,\n            title: !clusterId ? 'Aguardando processamento...' : '',\n            children: isGeneratingQrCode ? 'Gerando QR Code...' : 'Gerar QR Code'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 488,\n            columnNumber: 13\n          }, this), qrCodeImage && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"qr-code-preview\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"QR Code Gerado:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 500,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                border: '1px solid #ccc',\n                padding: '10px',\n                margin: '10px 0'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"URL da imagem: \", qrCodeImage.length > 50 ? qrCodeImage.substring(0, 50) + '...' : qrCodeImage]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 502,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Tipo: \", qrCodeImage.startsWith('blob:') ? 'Blob URL' : 'URL direta']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 503,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 501,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n              src: qrCodeImage,\n              alt: \"QR Code do Cluster\",\n              className: \"qr-code-image\",\n              onLoad: e => console.log('Imagem carregada com sucesso!', e),\n              onError: e => console.error('Erro ao carregar a imagem:', e),\n              style: {\n                maxWidth: '100%',\n                border: '1px solid red'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 505,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"qr-code-actions\",\n              children: /*#__PURE__*/_jsxDEV(\"a\", {\n                href: qrCodeImage,\n                download: `qrcode-${clusterId}.png`,\n                className: \"download-qr-btn\",\n                onClick: e => {\n                  console.log('Tentando baixar a imagem:', qrCodeImage);\n                  // Se for uma URL de blob, forçar o download\n                  if (qrCodeImage.startsWith('blob:')) {\n                    e.preventDefault();\n                    const link = document.createElement('a');\n                    link.href = qrCodeImage;\n                    link.download = `qrcode-${clusterId}.png`;\n                    document.body.appendChild(link);\n                    link.click();\n                    document.body.removeChild(link);\n                  }\n                },\n                children: \"Baixar QR Code\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 514,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 513,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 499,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 487,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 435,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 397,\n    columnNumber: 5\n  }, this);\n}\n_s(CriarEtiqueta, \"+msiWArab6OvdQ3a/XfodnhERZA=\");\n_c = CriarEtiqueta;\nexport default CriarEtiqueta;\nvar _c;\n$RefreshReg$(_c, \"CriarEtiqueta\");","map":{"version":3,"names":["React","useState","useRef","useEffect","XLSX","API_ENDPOINTS","jsxDEV","_jsxDEV","CriarEtiqueta","_s","imei","setImei","excelData","setExcelData","isLoading","setIsLoading","progress","setProgress","total","processed","success","errors","clusterId","setClusterId","isGeneratingQrCode","setIsGeneratingQrCode","qrCodeImage","setQrCodeImage","fileInputRef","length","handleGenerateQrCode","console","error","alert","log","url","CLUSTER_QRCODE","timestamp","Date","getTime","urlWithCacheBust","includes","headResponse","fetch","method","headers","redirect","status","type","redirected","Object","fromEntries","entries","finalUrl","location","get","URL","toString","response","contentType","ok","startsWith","blob","size","reader","FileReader","Promise","resolve","onloadend","result","onerror","imageUrl","createObjectURL","readAsDataURL","text","substring","imgMatch","match","imgSrc","Error","corsError","iframe","document","createElement","style","display","body","appendChild","onload","iframeDoc","contentDocument","contentWindow","img","querySelector","src","removeChild","documentElement","outerHTML","html","e","setTimeout","contains","message","handleImeiChange","target","value","enviarLoteParaAPI","lote","loteIndex","totalLotes","CLUSTERS","JSON","stringify","nome","imeis","descricao","data","json","cluster_id","processarIMEsEmLotes","tamanhoLote","lotes","i","push","slice","resultados","prev","loteAtual","resultado","handleSubmit","preventDefault","trim","imeiUnico","csvContent","Blob","file","File","processarArquivoCSV","map","item","IMEI","Imei","filter","Boolean","join","handleClearFile","formData","FormData","append","PROCESSAR_CSV","searchParams","statusText","handleFileUpload","files","name","endsWith","current","className","children","fileName","_jsxFileName","lineNumber","columnNumber","accept","onChange","ref","id","onClick","getElementById","click","onSubmit","htmlFor","required","disabled","placeholder","width","title","border","padding","margin","alt","onLoad","onError","maxWidth","href","download","link","_c","$RefreshReg$"],"sources":["C:/Users/mrmst/OneDrive/Documentos/Front End/ClusterWarehouse/src/Components/CriarEtiqueta.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport * as XLSX from 'xlsx';\nimport { API_ENDPOINTS } from '../config';\nimport './CriarEtiqueta.css';\n\nfunction CriarEtiqueta() {\n  const [imei, setImei] = useState('');\n  const [excelData, setExcelData] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [progress, setProgress] = useState({ total: 0, processed: 0, success: 0, errors: 0 });\n  const [clusterId, setClusterId] = useState(null);\n  const [isGeneratingQrCode, setIsGeneratingQrCode] = useState(false);\n  const [qrCodeImage, setQrCodeImage] = useState(null);\n  const fileInputRef = useRef(null);\n  \n  // Limpar o progresso quando os dados do Excel forem alterados\n  useEffect(() => {\n    if (excelData.length === 0) {\n      setProgress({ total: 0, processed: 0, success: 0, errors: 0 });\n    }\n  }, [excelData]);\n\n  const handleGenerateQrCode = async () => {\n    if (!clusterId) {\n      console.error('Nenhum clusterId disponível');\n      alert('Erro: Nenhum clusterId disponível para gerar o QR code');\n      return;\n    }\n    \n    console.log('Iniciando geração do QR code para o cluster:', clusterId);\n    setIsGeneratingQrCode(true);\n    \n    try {\n      // 1. Primeiro tenta a abordagem direta com CORS\n      const url = API_ENDPOINTS.CLUSTER_QRCODE(clusterId);\n      const timestamp = new Date().getTime();\n      const urlWithCacheBust = `${url}${url.includes('?') ? '&' : '?'}_=${timestamp}`;\n      \n      console.log('Tentando carregar QR code de:', urlWithCacheBust);\n      \n      // Tenta primeiro com CORS\n      try {\n        // Primeiro faz uma requisição HEAD para verificar o tipo de conteúdo\n        const headResponse = await fetch(urlWithCacheBust, {\n          method: 'HEAD',\n          headers: {\n            'Accept': 'image/png,image/*;q=0.8',\n            'Cache-Control': 'no-cache'\n          },\n          redirect: 'manual' // Não seguir redirecionamentos automaticamente\n        });\n        \n        console.log('Resposta HEAD:', {\n          status: headResponse.status,\n          type: headResponse.type,\n          redirected: headResponse.redirected,\n          url: headResponse.url,\n          headers: Object.fromEntries(headResponse.headers.entries())\n        });\n        \n        // Se for um redirecionamento, pega a nova URL\n        let finalUrl = urlWithCacheBust;\n        if ([301, 302, 303, 307, 308].includes(headResponse.status)) {\n          const location = headResponse.headers.get('location');\n          if (location) {\n            finalUrl = new URL(location, url).toString();\n            console.log('Redirecionado para:', finalUrl);\n          }\n        }\n        \n        // Agora faz a requisição GET para a URL final\n        const response = await fetch(finalUrl, {\n          method: 'GET',\n          headers: {\n            'Accept': 'image/png,image/*;q=0.8',\n            'Cache-Control': 'no-cache'\n          }\n        });\n        \n        const contentType = response.headers.get('content-type') || '';\n        console.log('Content-Type da resposta:', contentType);\n        \n        if (response.ok) {\n          // Se for uma imagem, processa normalmente\n          if (contentType.startsWith('image/')) {\n            const blob = await response.blob();\n            if (blob && blob.size > 0) {\n              const reader = new FileReader();\n              return new Promise((resolve) => {\n                reader.onloadend = () => {\n                  setQrCodeImage(reader.result);\n                  resolve();\n                };\n                reader.onerror = (error) => {\n                  console.error('Erro ao ler o blob:', error);\n                  const imageUrl = URL.createObjectURL(blob);\n                  setQrCodeImage(imageUrl);\n                  resolve();\n                };\n                reader.readAsDataURL(blob);\n              });\n            }\n          } else {\n            // Se não for uma imagem, tenta extrair a URL da imagem da resposta\n            const text = await response.text();\n            console.log('Resposta não é uma imagem:', text.substring(0, 200) + '...');\n            \n            // Tenta encontrar uma URL de imagem na resposta\n            const imgMatch = text.match(/<img[^>]+src=\"([^\">]+)\"/i);\n            if (imgMatch && imgMatch[1]) {\n              const imgSrc = new URL(imgMatch[1], finalUrl).toString();\n              console.log('Encontrada URL de imagem na resposta:', imgSrc);\n              setQrCodeImage(imgSrc);\n              return;\n            }\n            \n            throw new Error('A resposta não contém uma imagem válida');\n          }\n        }\n      } catch (corsError) {\n        console.log('Erro na requisição CORS, tentando abordagem alternativa...', corsError);\n      }\n      \n      // 2. Se a abordagem CORS falhar, tenta usar um iframe para exibir a URL\n      console.log('Tentando carregar QR code em um iframe...');\n      \n      // Cria um iframe temporário para carregar a página\n      const iframe = document.createElement('iframe');\n      iframe.style.display = 'none';\n      document.body.appendChild(iframe);\n      \n      return new Promise((resolve) => {\n        iframe.onload = async () => {\n          try {\n            // Tenta capturar o conteúdo do iframe\n            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;\n            \n            // Tenta encontrar uma imagem no iframe\n            const img = iframeDoc.querySelector('img');\n            if (img && img.src) {\n              console.log('Imagem encontrada no iframe:', img.src);\n              setQrCodeImage(img.src);\n              document.body.removeChild(iframe);\n              resolve();\n              return;\n            }\n            \n            // Se não encontrar, tiga o conteúdo do iframe\n            console.log('Conteúdo do iframe:', iframeDoc.documentElement.outerHTML.substring(0, 500) + '...');\n            \n            // Tenta extrair a URL da imagem do HTML\n            const html = iframeDoc.documentElement.outerHTML;\n            const imgMatch = html.match(/<img[^>]+src=[\"']([^\"']+)[\"']/i);\n            if (imgMatch && imgMatch[1]) {\n              const imgSrc = new URL(imgMatch[1], url).toString();\n              console.log('URL da imagem extraída:', imgSrc);\n              setQrCodeImage(imgSrc);\n              document.body.removeChild(iframe);\n              resolve();\n              return;\n            }\n            \n            throw new Error('Não foi possível encontrar uma imagem na resposta');\n          } catch (e) {\n            console.error('Erro ao processar iframe:', e);\n            // Se tudo falhar, tenta usar a URL diretamente\n            setQrCodeImage(urlWithCacheBust);\n            document.body.removeChild(iframe);\n            resolve();\n          }\n        };\n        \n        // Define um timeout para remover o iframe se algo der errado\n        setTimeout(() => {\n          if (document.body.contains(iframe)) {\n            document.body.removeChild(iframe);\n            setQrCodeImage(urlWithCacheBust);\n            resolve();\n          }\n        }, 5000);\n        \n        // Carrega a URL no iframe\n        iframe.src = urlWithCacheBust;\n      });\n      \n    } catch (error) {\n      console.error('Erro ao gerar QR code:', error);\n      alert(`Erro ao gerar QR code: ${error.message}\\n\\nVerifique se o servidor está rodando e acessível.`);\n    } finally {\n      setIsGeneratingQrCode(false);\n    }\n  };\n\nconst handleImeiChange = (e) => {\n    setImei(e.target.value);\n  };\n\n  const enviarLoteParaAPI = async (lote, loteIndex, totalLotes) => {\n    try {\n      const response = await fetch(API_ENDPOINTS.CLUSTERS, {\n        method: 'POST',\n        headers: {\n          'accept': 'application/json',\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          nome: `Lote ${loteIndex + 1} de ${totalLotes}`,\n          imeis: lote,\n          descricao: `Lote ${loteIndex + 1} de IMEIs processados`\n        })\n      });\n\n      if (!response.ok) {\n        throw new Error(`Erro no lote ${loteIndex + 1}: ${response.status}`);\n      }\n\n      const data = await response.json();\n      if (data.cluster_id) {\n        setClusterId(data.cluster_id);\n      }\n      return { success: true, data };\n    } catch (error) {\n      console.error(`Erro no lote ${loteIndex + 1}:`, error);\n      return { success: false, error, imeis: lote };\n    }\n  };\n\n  const processarIMEsEmLotes = async (imeis, tamanhoLote = 10) => {\n    const lotes = [];\n    for (let i = 0; i < imeis.length; i += tamanhoLote) {\n      lotes.push(imeis.slice(i, i + tamanhoLote));\n    }\n\n    const resultados = [];\n    const totalLotes = lotes.length;\n\n    for (let i = 0; i < lotes.length; i++) {\n      const lote = lotes[i];\n      setProgress(prev => ({\n        ...prev,\n        loteAtual: i + 1,\n        totalLotes\n      }));\n      \n      const resultado = await enviarLoteParaAPI(lote, i, totalLotes);\n      resultados.push(resultado);\n      \n      setProgress(prev => ({\n        ...prev,\n        processed: prev.processed + lote.length,\n        success: resultado.success ? prev.success + lote.length : prev.success,\n        errors: !resultado.success ? prev.errors + lote.length : prev.errors\n      }));\n    }\n\n    return resultados;\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    \n    if (isLoading) return;\n    \n    try {\n      if (imei.trim()) {\n        // Processar apenas o IMEI digitado\n        const imeiUnico = imei.trim();\n        console.log('Processando IMEI:', imeiUnico);\n        \n        setIsLoading(true);\n        setProgress({\n          total: 1,\n          processed: 0,\n          success: 0,\n          errors: 0\n        });\n        \n        // Criar um arquivo CSV temporário com o IMEI\n        const csvContent = `IMEI\\n${imeiUnico}`;\n        const blob = new Blob([csvContent], { type: 'text/csv' });\n        const file = new File([blob], 'imei.csv', { type: 'text/csv' });\n        \n        // Processar o arquivo CSV\n        await processarArquivoCSV(file);\n        setImei('');\n      } else if (excelData.length > 0) {\n        // Se houver dados do Excel, converter para CSV e enviar\n        const csvContent = [\n          'IMEI', // Cabeçalho\n          ...excelData.map(item => (item.IMEI || item.imei || item.Imei || '').trim()).filter(Boolean)\n        ].join('\\n');\n        \n        const blob = new Blob([csvContent], { type: 'text/csv' });\n        const file = new File([blob], 'imeis.csv', { type: 'text/csv' });\n        \n        await processarArquivoCSV(file);\n        handleClearFile();\n      } else {\n        alert('Por favor, insira um IMEI, carregue um arquivo CSV ou Excel.');\n      }\n    } catch (error) {\n      console.error('Erro ao processar:', error);\n      alert(error.message || 'Ocorreu um erro ao processar. Verifique o console para mais detalhes.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const processarArquivoCSV = async (file) => {\n    setIsLoading(true);\n    setProgress({\n      total: 1,\n      processed: 0,\n      success: 0,\n      errors: 0\n    });\n\n    const formData = new FormData();\n    formData.append('file', file);\n\n    try {\n      const url = new URL(API_ENDPOINTS.PROCESSAR_CSV);\n      url.searchParams.append('criar_cluster_automatico', 'true');\n      url.searchParams.append('nome_cluster', 'Cluster gerado a partir de CSV');\n\n      const response = await fetch(url, {\n        method: 'POST',\n        headers: {\n          'accept': 'application/json',\n        },\n        body: formData\n      });\n\n      if (!response.ok) {\n        throw new Error(`Erro ao processar o arquivo: ${response.statusText}`);\n      }\n\n      const result = await response.json();\n      console.log('Arquivo processado com sucesso:', result);\n      \n      // Atualiza o estado do clusterId se estiver na resposta\n      if (result.cluster_id) {\n        setClusterId(result.cluster_id);\n      }\n      \n      setProgress(prev => ({\n        ...prev,\n        processed: 1,\n        success: 1\n      }));\n\n      return result;\n    } catch (error) {\n      console.error('Erro ao processar o arquivo:', error);\n      setProgress(prev => ({\n        ...prev,\n        errors: 1\n      }));\n      throw error;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleFileUpload = async (e) => {\n    const file = e.target.files[0];\n    if (!file) return;\n\n    try {\n      // Verifica se é um arquivo CSV\n      if (!file.name.endsWith('.csv') && !file.type.includes('csv')) {\n        throw new Error('Por favor, selecione um arquivo CSV.');\n      }\n\n      // Processa o arquivo CSV diretamente\n      await processarArquivoCSV(file);\n      \n      // Limpa o input de arquivo\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (error) {\n      console.error('Erro:', error);\n      alert(error.message || 'Erro ao processar o arquivo. Verifique o console para mais detalhes.');\n    }\n  };\n\n  const handleClearFile = () => {\n    setExcelData([]);\n    setImei('');\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  return (\n    <div className=\"criar-etiqueta\">\n      <h2>Gerar Etiqueta de IMEI</h2>\n      \n      <div className=\"importar-excel\">\n        <h3>Importar IMEIs do Excel/CSV</h3>\n          <input\n            type=\"file\"\n            accept=\".csv, .xlsx, .xls\"\n            onChange={handleFileUpload}\n            ref={fileInputRef}\n            style={{ display: 'none' }}\n            id=\"file-upload\"\n          />\n        <div className=\"file-upload-container\">\n          <button \n            type=\"button\" \n            className=\"file-upload-button\"\n            onClick={() => document.getElementById('file-upload').click()}\n          >\n            {isLoading ? 'Processando...' : 'Selecionar Arquivo (CSV/Excel)'}\n          </button>\n          {excelData.length > 0 && (\n            <div className=\"file-info\">\n              <span>{excelData.length} IMEIs carregados</span>\n              <button \n                type=\"button\" \n                className=\"clear-button\"\n                onClick={handleClearFile}\n              >\n                Limpar\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n\n      <div className=\"divider\">ou</div>\n\n      <form onSubmit={handleSubmit}>\n        <div className=\"form-group\">\n          <label htmlFor=\"imei\">IMEI:</label>\n          <input\n            type=\"text\"\n            id=\"imei\"\n            name=\"imei\"\n            value={imei}\n            onChange={handleImeiChange}\n            required={excelData.length === 0}\n            disabled={excelData.length > 0}\n            placeholder=\"Digite o número do IMEI\"\n          />\n        </div>\n        \n        <div className=\"button-group\">\n          <button \n            type=\"submit\" \n            className=\"submit-button\"\n            disabled={isLoading}\n          >\n            {isLoading ? (\n              <span>Processando... {progress.processed}/{progress.total}</span>\n            ) : excelData.length > 0 ? (\n              `Gerar ${excelData.length} Etiquetas`\n            ) : (\n              'Processar IMEIs'\n            )}\n          </button>\n          \n          {/* Barra de progresso */}\n          {isLoading && progress.total > 0 && (\n            <div className=\"progress-container\">\n              <p>Processando: {progress.processed} de {progress.total} IMEIs</p>\n              <div className=\"progress-bar\">\n                <div \n                  className=\"progress-bar-fill\" \n                  style={{ width: `${(progress.processed / progress.total) * 100}%` }}\n                ></div>\n              </div>\n              <p>Sucesso: {progress.success} | Erros: {progress.errors}</p>\n              {progress.loteAtual && (\n                <div className=\"progress-info\">\n                  Lote {progress.loteAtual} de {progress.totalLotes} • \n                  Sucessos: {progress.success} • \n                  Erros: {progress.errors}\n                </div>\n              )}\n            </div>\n          )}\n          \n          {/* Botão de Gerar QR Code - Sempre visível */}\n          <div className=\"qr-code-button-container\">\n            <button \n              className={`criar-etiqueta-btn ${!clusterId || isGeneratingQrCode ? 'disabled' : ''}`}\n              onClick={handleGenerateQrCode}\n              disabled={!clusterId || isGeneratingQrCode}\n              title={!clusterId ? 'Aguardando processamento...' : ''}\n            >\n              {isGeneratingQrCode ? 'Gerando QR Code...' : 'Gerar QR Code'}\n            </button>\n            \n            {/* Exibição do QR Code */}\n            {qrCodeImage && (\n              <div className=\"qr-code-preview\">\n                <h4>QR Code Gerado:</h4>\n                <div style={{ border: '1px solid #ccc', padding: '10px', margin: '10px 0' }}>\n                  <p>URL da imagem: {qrCodeImage.length > 50 ? qrCodeImage.substring(0, 50) + '...' : qrCodeImage}</p>\n                  <p>Tipo: {qrCodeImage.startsWith('blob:') ? 'Blob URL' : 'URL direta'}</p>\n                </div>\n                <img \n                  src={qrCodeImage} \n                  alt=\"QR Code do Cluster\" \n                  className=\"qr-code-image\"\n                  onLoad={(e) => console.log('Imagem carregada com sucesso!', e)}\n                  onError={(e) => console.error('Erro ao carregar a imagem:', e)}\n                  style={{ maxWidth: '100%', border: '1px solid red' }}\n                />\n                <div className=\"qr-code-actions\">\n                  <a \n                    href={qrCodeImage} \n                    download={`qrcode-${clusterId}.png`}\n                    className=\"download-qr-btn\"\n                    onClick={(e) => {\n                      console.log('Tentando baixar a imagem:', qrCodeImage);\n                      // Se for uma URL de blob, forçar o download\n                      if (qrCodeImage.startsWith('blob:')) {\n                        e.preventDefault();\n                        const link = document.createElement('a');\n                        link.href = qrCodeImage;\n                        link.download = `qrcode-${clusterId}.png`;\n                        document.body.appendChild(link);\n                        link.click();\n                        document.body.removeChild(link);\n                      }\n                    }}\n                  >\n                    Baixar QR Code\n                  </a>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </form>\n    </div>\n  );\n}\n\nexport default CriarEtiqueta;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}